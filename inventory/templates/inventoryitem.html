{% extends "section.html" %}
{% load simptags %}
{% block title_tag %}Item{% endblock %}
{% block page_heading %}Item{% endblock %}
{% block content %}
{% if form %}
    {% if form.instance.pk %}
    <form action="{% url inventoryitem item_id=form.instance.pk %}" method="POST">
    {% else %}
    <form action="{% url inventoryitem %}" method="POST">
    {% endif %}
        {% csrf_token %}
        {% for field in form %}
        <p>{{ field.label_tag }} {{ field }}{% if field.errors %}<br/>
           {{ field.errors }}{% endif %}</p>
        {% endfor %}
        <div class="markup-buttons"></div>
        <button class="save">Submit</button>
    </form>
{% else %}
    <table class="basetable">
        <tr>
            <th colspan="2">Name</th>
            <th>Markup Scheme</th>
            <th>Acquisition Dates</th>
        </tr>
        <tr>
            <td class="name middle" colspan="2">{{ item.name }}</td>
            <td>{{ item.markup_scheme|render_markup_scheme|safe }}</td>
            <td class="middle">
                {% for a_date in item.acquired %}
                    {{ a_date }}<br />
                {% empty %}
                    Never
                {% endfor %}
            </td>
        </tr>
        <tr>
            <th colspan="2">Quantity Acquired</th>
            <th>Quantity Sold</th>
            <th>Quantity Remaining</th>
        </tr>
        <tr>
            <td colspan="2" class="number">{{ item.total_acquired }}</td>
            <td class="number">{{ item.total_sold }}</td>
            <td class="number">{{ item.calculate_quantity }}</td>
        </tr>
        <tr>
            <th colspan="2">Shrink</th>
            <th>Shrink Cost</th>
            <th>Shrink Potential</th>
        </tr>
        <tr>
            <td colspan="2" class="number">{{ item.shrink_quantity }}</td>
            <td class="number">${{ item.calculate_shrink_at_cost|floatformat:0 }}</td>
            <td class="number">${{ item.calculate_shrink_at_potential|floatformat:0 }}</td>
        </tr>
        <tr>
            <th>Purchase Value</th>
            <th>Potential Value</th>
            <th>Recovered Value</th>
            <th>Profit</th>
        </tr>
        <tr>
            <td class="number">${{ item.purchase_price|floatformat:2 }}</td>
            <td class="number">${{ item.calculate_potential_value|floatformat:-2}}</td>
            <td class="number">${{ item.total_recovered|floatformat:2 }}</td>
            <td class="number">${{ item.calculate_profit|floatformat:2 }}</td>
        </tr>
    </table>
    <a href="{% url inventoryitem item_id=item.pk %}">Edit this Item</a>
{% endif %}
{% endblock content %}
